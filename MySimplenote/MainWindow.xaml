<Window x:Class="MySimplenote.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MySimplenote"
        xmlns:vm="clr-namespace:MySimplenote.ViewModels"
        xmlns:converters="clr-namespace:MySimplenote.Converters"
        xmlns:views="clr-namespace:MySimplenote.Views"
        mc:Ignorable="d"
        Title="MySimplenote" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen">
    
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300"/>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Левая панель со списком заметок -->
        <Border Grid.Column="0" Style="{StaticResource SidebarBorderStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Заголовок и кнопка создания -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="15,15,15,10">
                    <TextBlock Text="Заметки" FontSize="18" Style="{StaticResource SectionHeaderTextStyle}"/>
                    <Button Content="+" Margin="10,0,0,0"
                            Command="{Binding CreateNoteCommand}"
                            Style="{StaticResource CreateButtonStyle}"/>
                </StackPanel>
                
                <!-- Поиск -->
                <Border Grid.Row="1" Margin="15,0,15,15" Style="{StaticResource SearchBorderStyle}">
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource SearchTextBoxStyle}">
                        <TextBox.InputBindings>
                            <KeyBinding Key="Enter" Command="{Binding SearchCommand}"/>
                        </TextBox.InputBindings>
                    </TextBox>
                </Border>
                
                <!-- Список заметок -->
                <ListBox Grid.Row="2" ItemsSource="{Binding Notes}" 
                         SelectedItem="{Binding SelectedNote}"
                         Style="{StaticResource NotesListBoxStyle}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border Style="{StaticResource NoteItemBorderStyle}">
                                <StackPanel>
                                    <TextBlock Text="{Binding Title}" Style="{StaticResource NoteTitleTextStyle}"/>
                                    <TextBlock Text="{Binding Content}" Style="{StaticResource NoteContentTextStyle}"/>
                                    <TextBlock Text="{Binding UpdatedAt, StringFormat='dd.MM.yyyy HH:mm'}" 
                                               Style="{StaticResource NoteDateTextStyle}"/>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem" BasedOn="{StaticResource NoteListBoxItemStyle}"/>
                    </ListBox.ItemContainerStyle>
                </ListBox>
            </Grid>
        </Border>
        
        <!-- Панель тэгов -->
        <views:TagPanel Grid.Column="1" DataContext="{Binding}"/>
        
        <!-- Правая панель с редактором -->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- Заголовок заметки -->
            <Border Grid.Row="0" Style="{StaticResource HeaderBorderStyle}">
                <TextBox Text="{Binding SelectedNote.Title, UpdateSourceTrigger=PropertyChanged}"
                         Style="{StaticResource TitleTextBoxStyle}"
                         IsEnabled="{Binding SelectedNote, Converter={x:Static converters:BooleanConverter.IsNotNull}}">
                </TextBox>
            </Border>
            
            <!-- Содержимое заметки -->
            <TextBox Grid.Row="1" Text="{Binding SelectedNote.Content, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource ContentTextBoxStyle}"
                     IsEnabled="{Binding SelectedNote, Converter={x:Static converters:BooleanConverter.IsNotNull}}">
            </TextBox>
            
            <!-- Панель кнопок -->
            <Border Grid.Row="2" Style="{StaticResource FooterBorderStyle}">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Сохранить" Margin="0,0,10,0"
                            Command="{Binding SaveNoteCommand}"
                            Style="{StaticResource PrimaryButtonStyle}"
                            IsEnabled="{Binding SelectedNote, Converter={x:Static converters:BooleanConverter.IsNotNull}}"/>
                    <Button Content="Удалить" 
                            Command="{Binding DeleteNoteCommand}"
                            Style="{StaticResource DangerButtonStyle}"
                            IsEnabled="{Binding SelectedNote, Converter={x:Static converters:BooleanConverter.IsNotNull}}"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>
